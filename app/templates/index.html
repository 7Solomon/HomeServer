{% extends "base.html" %}

{% block title %}Dashboard - Heim Speicher{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}">
<div class="dashboard">
    <div class="welcome-section">
        {% if current_user.is_authenticated %}
        <h2>Willkommen zurück, {{ current_user.username }}! <i class="fas fa-hand-wave"></i></h2>
        <p class="welcome-subtitle">Hier ist eine Übersicht über Ihre Dateien und Aktivitäten</p>
        {% else %}
        <h2>Willkommen bei Heim Speicher! <i class="fas fa-hand-wave"></i></h2>
        <p class="welcome-subtitle">Ihr sicherer Cloud-Speicher</p>
        {% endif %}
    </div>

    <div class="dashboard-cards">
        {% if current_user.is_authenticated %}
        <div class="card">
            <div class="card-icon">
                <i class="fas fa-folder-open"></i>
            </div>
            <div class="card-content">
                <h3>Dateien verwalten</h3>
                <p>Durchsuchen, hochladen und organisieren Sie Ihre Dateien sicher in der Cloud</p>
                <a href="{{ url_for('storage.files') }}" class="btn btn-primary">
                    <i class="fas fa-arrow-right"></i> Dateien öffnen
                </a>
            </div>
        </div>
        
        <div class="card">
            <div class="card-icon">
                <i class="fas fa-file-alt"></i>
            </div>
            <div class="card-content">
                <h3>Overleaf</h3>
                <p>Lokaler Latex-Editor</p>
                <a href="{{ url_for('storage.start_overleaf') }}" class="btn btn-primary">
                    <i class="fas fa-arrow-right"></i> Overleaf starten
                </a>
            </div>
        </div>

        <div class="card">
            <div class="card-icon">
                <i class="fas fa-music"></i>
            </div>
            <div class="card-content">
                <h3>OCR</h3>
                <p>Erstellen von Noten</p>
                <a href="{{ url_for('ocr.page') }}" class="btn btn-primary">
                    <i class="fas fa-arrow-right"></i> OCR starten
                </a>
            </div>
        </div>

        <div class="card">
            <div class="card-icon">
                <i class="fas fa-download"></i>
            </div>
            <div class="card-content">
                <h3>P2P Download</h3>
                <p>Laden Sie Dateien direkt von anderen Quellen herunter</p>
                <a href="{{ url_for('storage.p2p_download') }}" class="btn btn-primary">
                    <i class="fas fa-arrow-right"></i> Downloads
                </a>
            </div>
        </div>

        {% if current_user.is_admin %}
        <div class="card">
            <div class="card-icon">
                <i class="fas fa-users-cog"></i>
            </div>
            <div class="card-content">
                <h3>Benutzerverwaltung</h3>
                <p>Verwalten Sie Benutzeranfragen und Systemeinstellungen</p>
                <a href="{{ url_for('admin.pending_users') }}" class="btn btn-primary">
                    <i class="fas fa-arrow-right"></i> Admin-Bereich
                </a>
            </div>
        </div>

        <div class="card">
            <div class="card-icon">
                <i class="fas fa-upload"></i>
            </div>
            <div class="card-content">
                <h3>Predigt Upload</h3>
                <p>Laden Sie die Predigt hoch</p>
                <a href="{{ url_for('storage.predigt_upload') }}" class="btn btn-primary">
                    <i class="fas fa-arrow-right"></i> Predigt Upload
                </a>
            </div>
        </div>
        {% endif %}

        {% else %}
        <!-- Cards for non-logged-in users -->
        <div class="card">
            <div class="card-icon">
                <i class="fas fa-download"></i>
            </div>
            <div class="card-content">
                <h3>P2P Download</h3>
                <p>Laden Sie Dateien direkt von anderen Quellen herunter</p>
                <a href="{{ url_for('storage.p2p_download') }}" class="btn btn-primary">
                    <i class="fas fa-arrow-right"></i> Downloads
                </a>
            </div>
        </div>

        <div class="card">
            <div class="card-icon">
                <i class="fas fa-sign-in-alt"></i>
            </div>
            <div class="card-content">
                <h3>Anmelden</h3>
                <p>Melden Sie sich an, um auf Ihre Dateien zuzugreifen</p>
                <a href="{{ url_for('auth.login') }}" class="btn btn-primary">
                    <i class="fas fa-arrow-right"></i> Zur Anmeldung
                </a>
            </div>
        </div>

        <div class="card">
            <div class="card-icon">
                <i class="fas fa-user-plus"></i>
            </div>
            <div class="card-content">
                <h3>Registrieren</h3>
                <p>Erstellen Sie ein Konto für vollen Zugriff</p>
                <a href="{{ url_for('auth.register') }}" class="btn btn-primary">
                    <i class="fas fa-arrow-right"></i> Jetzt registrieren
                </a>
            </div>
        </div>
        {% endif %}
    </div>

    {% if current_user.is_authenticated %}
    <div class="stats-section">
        <div class="quick-stats">
            <h3><i class="fas fa-chart-pie"></i> Speichernutzung</h3>
            <div class="usage-bar">
                <div class="usage-fill" style="width: '{{ storage_percent }}%'"></div>
            </div>
            <div class="usage-info">
                <p><strong>{{ used_storage }}</strong> von <strong>{{ total_storage }}</strong> verwendet</p>
                <p class="usage-percent">{{ storage_percent }}% belegt</p>
            </div>
        </div>
    </div>
    {% endif %}
</div>

{% endblock %}